{"remainingRequest":"E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\node_modules\\babel-loader\\lib\\index.js!E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\src\\views\\component\\singleUpload.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\src\\views\\component\\singleUpload.vue","mtime":1694356754356},{"path":"E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\babel.config.js","mtime":1681796553875},{"path":"E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHBvbGljeSB9IGZyb20gJ0AvYXBpL29zcy9wb2xpY3knOwppbXBvcnQgeyBnZXRVVUlEIH0gZnJvbSAnQC91dGlscyc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnU2luZ2xlVXBsb2FkJywKICBwcm9wczogewogICAgdmFsdWU6IFN0cmluZwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGltYWdlVXJsOiBmdW5jdGlvbiBpbWFnZVVybCgpIHsKICAgICAgcmV0dXJuIHRoaXMudmFsdWU7CiAgICB9LAogICAgaW1hZ2VOYW1lOiBmdW5jdGlvbiBpbWFnZU5hbWUoKSB7CiAgICAgIGlmICh0aGlzLnZhbHVlICE9IG51bGwgJiYgdGhpcy52YWx1ZSAhPT0gJycpIHsKICAgICAgICByZXR1cm4gdGhpcy52YWx1ZS5zdWJzdHIodGhpcy52YWx1ZS5sYXN0SW5kZXhPZignLycpICsgMSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0sCiAgICBmaWxlTGlzdDogZnVuY3Rpb24gZmlsZUxpc3QoKSB7CiAgICAgIHJldHVybiBbewogICAgICAgIG5hbWU6IHRoaXMuaW1hZ2VOYW1lLAogICAgICAgIHVybDogdGhpcy5pbWFnZVVybAogICAgICB9XTsKICAgIH0sCiAgICBzaG93RmlsZUxpc3Q6IHsKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMudmFsdWUgIT09IG51bGwgJiYgdGhpcy52YWx1ZSAhPT0gJycgJiYgdGhpcy52YWx1ZSAhPT0gdW5kZWZpbmVkOwogICAgICB9LAogICAgICBzZXQ6IGZ1bmN0aW9uIHNldChuZXdWYWx1ZSkge30KICAgIH0KICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkYXRhT2JqOiB7CiAgICAgICAgcG9saWN5OiAnJywKICAgICAgICBzaWduYXR1cmU6ICcnLAogICAgICAgIGtleTogJycsCiAgICAgICAgb3NzYWNjZXNzS2V5SWQ6ICcnLAogICAgICAgIGRpcjogJycsCiAgICAgICAgaG9zdDogJycKICAgICAgICAvLyBjYWxsYmFjazonJywKICAgICAgfSwKCiAgICAgIGRpYWxvZ1Zpc2libGU6IGZhbHNlCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgZW1pdElucHV0OiBmdW5jdGlvbiBlbWl0SW5wdXQodmFsKSB7CiAgICAgIHRoaXMuJGVtaXQoJ2lucHV0JywgdmFsKTsKICAgIH0sCiAgICBoYW5kbGVSZW1vdmU6IGZ1bmN0aW9uIGhhbmRsZVJlbW92ZShmaWxlLCBmaWxlTGlzdCkgewogICAgICB0aGlzLmVtaXRJbnB1dCgnJyk7CiAgICB9LAogICAgaGFuZGxlUHJldmlldzogZnVuY3Rpb24gaGFuZGxlUHJldmlldyhmaWxlKSB7CiAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IHRydWU7CiAgICB9LAogICAgYmVmb3JlVXBsb2FkOiBmdW5jdGlvbiBiZWZvcmVVcGxvYWQoZmlsZSkgewogICAgICB2YXIgX3NlbGYgPSB0aGlzOwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIHBvbGljeSgpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygn5ZON5bqU55qE5pWw5o2uJywgcmVzcG9uc2UpOwogICAgICAgICAgX3NlbGYuZGF0YU9iai5wb2xpY3kgPSByZXNwb25zZS5kYXRhLnBvbGljeTsKICAgICAgICAgIF9zZWxmLmRhdGFPYmouc2lnbmF0dXJlID0gcmVzcG9uc2UuZGF0YS5zaWduYXR1cmU7CiAgICAgICAgICBfc2VsZi5kYXRhT2JqLm9zc2FjY2Vzc0tleUlkID0gcmVzcG9uc2UuZGF0YS5hY2Nlc3NpZDsKICAgICAgICAgIF9zZWxmLmRhdGFPYmoua2V5ID0gcmVzcG9uc2UuZGF0YS5kaXIgKyBnZXRVVUlEKCkgKyAnXyR7ZmlsZW5hbWV9JzsKICAgICAgICAgIF9zZWxmLmRhdGFPYmouZGlyID0gcmVzcG9uc2UuZGF0YS5kaXI7CiAgICAgICAgICBfc2VsZi5kYXRhT2JqLmhvc3QgPSByZXNwb25zZS5kYXRhLmhvc3Q7CiAgICAgICAgICBjb25zb2xlLmxvZygn5ZON5bqU55qE5pWw5o2uMjIy44CC44CC44CCJywgX3NlbGYuZGF0YU9iaik7CiAgICAgICAgICByZXNvbHZlKHRydWUpOwogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICAgIHJlamVjdChmYWxzZSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIGhhbmRsZVVwbG9hZFN1Y2Nlc3M6IGZ1bmN0aW9uIGhhbmRsZVVwbG9hZFN1Y2Nlc3MocmVzLCBmaWxlKSB7CiAgICAgIGNvbnNvbGUubG9nKCfkuIrkvKDmiJDlip8uLi4nKTsKICAgICAgdGhpcy5zaG93RmlsZUxpc3QgPSB0cnVlOwogICAgICB0aGlzLmZpbGVMaXN0LnBvcCgpOwogICAgICB0aGlzLmZpbGVMaXN0LnB1c2goewogICAgICAgIG5hbWU6IGZpbGUubmFtZSwKICAgICAgICB1cmw6IHRoaXMuZGF0YU9iai5ob3N0ICsgJy8nICsgdGhpcy5kYXRhT2JqLmtleS5yZXBsYWNlKCIke2ZpbGVuYW1lfSIsIGZpbGUubmFtZSkKICAgICAgfSk7CiAgICAgIHRoaXMuZW1pdElucHV0KHRoaXMuZmlsZUxpc3RbMF0udXJsKTsKICAgIH0KICB9Cn07"},{"version":3,"names":["policy","getUUID","name","props","value","String","computed","imageUrl","imageName","substr","lastIndexOf","fileList","url","showFileList","get","undefined","set","newValue","data","dataObj","signature","key","ossaccessKeyId","dir","host","dialogVisible","methods","emitInput","val","$emit","handleRemove","file","handlePreview","beforeUpload","_self","Promise","resolve","reject","then","response","console","log","accessid","catch","err","handleUploadSuccess","res","pop","push","replace"],"sources":["src/views/component/singleUpload.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <el-upload\r\n      action=\"http://gulimall-xfwang.oss-cn-shanghai.aliyuncs.com\"\r\n      :data=\"dataObj\"\r\n      list-type=\"picture\"\r\n      :multiple=\"false\" :show-file-list=\"showFileList\"\r\n      :file-list=\"fileList\"\r\n      :before-upload=\"beforeUpload\"\r\n      :on-remove=\"handleRemove\"\r\n      :on-success=\"handleUploadSuccess\"\r\n      :on-preview=\"handlePreview\">\r\n      <el-button size=\"small\" type=\"primary\">点击上传</el-button>\r\n      <div slot=\"tip\" class=\"el-upload__tip\">只能上传jpg/png文件，且不超过10MB</div>\r\n    </el-upload>\r\n    <el-dialog :visible.sync=\"dialogVisible\">\r\n      <img width=\"100%\" :src=\"fileList[0].url\" alt=\"\">\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { policy } from '@/api/oss/policy'\r\nimport { getUUID } from '@/utils'\r\n\r\nexport default {\r\n  name: 'SingleUpload',\r\n  props: {\r\n    value: String\r\n  },\r\n  computed: {\r\n    imageUrl() {\r\n      return this.value;\r\n    },\r\n    imageName() {\r\n      if (this.value != null && this.value !== '') {\r\n        return this.value.substr(this.value.lastIndexOf('/') + 1)\r\n      } else {\r\n        return null;\r\n      }\r\n    },\r\n    fileList() {\r\n      return [{\r\n        name: this.imageName,\r\n        url: this.imageUrl\r\n      }]\r\n    },\r\n    showFileList: {\r\n      get: function() {\r\n        return this.value !== null && this.value !== '' && this.value !== undefined\r\n      },\r\n      set: function(newValue) {\r\n      }\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      dataObj: {\r\n        policy: '',\r\n        signature: '',\r\n        key: '',\r\n        ossaccessKeyId: '',\r\n        dir: '',\r\n        host: '',\r\n        // callback:'',\r\n      },\r\n      dialogVisible: false\r\n    }\r\n  },\r\n  methods: {\r\n    emitInput(val) {\r\n      this.$emit('input', val)\r\n    },\r\n    handleRemove(file, fileList) {\r\n      this.emitInput('')\r\n    },\r\n    handlePreview(file) {\r\n      this.dialogVisible = true\r\n    },\r\n    beforeUpload(file) {\r\n      const _self = this\r\n      return new Promise((resolve, reject) => {\r\n        policy().then(response => {\r\n          console.log('响应的数据', response)\r\n          _self.dataObj.policy = response.data.policy\r\n          _self.dataObj.signature = response.data.signature\r\n          _self.dataObj.ossaccessKeyId = response.data.accessid\r\n          _self.dataObj.key = response.data.dir + getUUID() + '_${filename}'\r\n          _self.dataObj.dir = response.data.dir\r\n          _self.dataObj.host = response.data.host\r\n          console.log('响应的数据222。。。', _self.dataObj)\r\n          resolve(true)\r\n        }).catch(err => {\r\n          reject(false)\r\n        })\r\n      })\r\n    },\r\n    handleUploadSuccess(res, file) {\r\n      console.log('上传成功...')\r\n      this.showFileList = true;\r\n      this.fileList.pop();\r\n      this.fileList.push({name: file.name, url: this.dataObj.host + '/' + this.dataObj.key.replace(\"${filename}\",file.name) });\r\n      this.emitInput(this.fileList[0].url);\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style>\r\n</style>\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAqBA,SAAAA,MAAA;AACA,SAAAC,OAAA;AAEA;EACAC,IAAA;EACAC,KAAA;IACAC,KAAA,EAAAC;EACA;EACAC,QAAA;IACAC,QAAA,WAAAA,SAAA;MACA,YAAAH,KAAA;IACA;IACAI,SAAA,WAAAA,UAAA;MACA,SAAAJ,KAAA,iBAAAA,KAAA;QACA,YAAAA,KAAA,CAAAK,MAAA,MAAAL,KAAA,CAAAM,WAAA;MACA;QACA;MACA;IACA;IACAC,QAAA,WAAAA,SAAA;MACA;QACAT,IAAA,OAAAM,SAAA;QACAI,GAAA,OAAAL;MACA;IACA;IACAM,YAAA;MACAC,GAAA,WAAAA,IAAA;QACA,YAAAV,KAAA,kBAAAA,KAAA,gBAAAA,KAAA,KAAAW,SAAA;MACA;MACAC,GAAA,WAAAA,IAAAC,QAAA,GACA;IACA;EACA;EACAC,IAAA,WAAAA,KAAA;IACA;MACAC,OAAA;QACAnB,MAAA;QACAoB,SAAA;QACAC,GAAA;QACAC,cAAA;QACAC,GAAA;QACAC,IAAA;QACA;MACA;;MACAC,aAAA;IACA;EACA;EACAC,OAAA;IACAC,SAAA,WAAAA,UAAAC,GAAA;MACA,KAAAC,KAAA,UAAAD,GAAA;IACA;IACAE,YAAA,WAAAA,aAAAC,IAAA,EAAApB,QAAA;MACA,KAAAgB,SAAA;IACA;IACAK,aAAA,WAAAA,cAAAD,IAAA;MACA,KAAAN,aAAA;IACA;IACAQ,YAAA,WAAAA,aAAAF,IAAA;MACA,IAAAG,KAAA;MACA,WAAAC,OAAA,WAAAC,OAAA,EAAAC,MAAA;QACArC,MAAA,GAAAsC,IAAA,WAAAC,QAAA;UACAC,OAAA,CAAAC,GAAA,UAAAF,QAAA;UACAL,KAAA,CAAAf,OAAA,CAAAnB,MAAA,GAAAuC,QAAA,CAAArB,IAAA,CAAAlB,MAAA;UACAkC,KAAA,CAAAf,OAAA,CAAAC,SAAA,GAAAmB,QAAA,CAAArB,IAAA,CAAAE,SAAA;UACAc,KAAA,CAAAf,OAAA,CAAAG,cAAA,GAAAiB,QAAA,CAAArB,IAAA,CAAAwB,QAAA;UACAR,KAAA,CAAAf,OAAA,CAAAE,GAAA,GAAAkB,QAAA,CAAArB,IAAA,CAAAK,GAAA,GAAAtB,OAAA;UACAiC,KAAA,CAAAf,OAAA,CAAAI,GAAA,GAAAgB,QAAA,CAAArB,IAAA,CAAAK,GAAA;UACAW,KAAA,CAAAf,OAAA,CAAAK,IAAA,GAAAe,QAAA,CAAArB,IAAA,CAAAM,IAAA;UACAgB,OAAA,CAAAC,GAAA,gBAAAP,KAAA,CAAAf,OAAA;UACAiB,OAAA;QACA,GAAAO,KAAA,WAAAC,GAAA;UACAP,MAAA;QACA;MACA;IACA;IACAQ,mBAAA,WAAAA,oBAAAC,GAAA,EAAAf,IAAA;MACAS,OAAA,CAAAC,GAAA;MACA,KAAA5B,YAAA;MACA,KAAAF,QAAA,CAAAoC,GAAA;MACA,KAAApC,QAAA,CAAAqC,IAAA;QAAA9C,IAAA,EAAA6B,IAAA,CAAA7B,IAAA;QAAAU,GAAA,OAAAO,OAAA,CAAAK,IAAA,cAAAL,OAAA,CAAAE,GAAA,CAAA4B,OAAA,gBAAAlB,IAAA,CAAA7B,IAAA;MAAA;MACA,KAAAyB,SAAA,MAAAhB,QAAA,IAAAC,GAAA;IACA;EACA;AACA"}]}