{"remainingRequest":"E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\src\\views\\goods\\banner.vue?vue&type=style&index=0&id=5b8a1e9f&scoped=true&lang=css&","dependencies":[{"path":"E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\src\\views\\goods\\banner.vue","mtime":1694357435892},{"path":"E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLmF2YXRhciB7DQogIHdpZHRoOiAxNDVweDsNCiAgaGVpZ2h0OiAxNDVweDsNCiAgZGlzcGxheTogYmxvY2s7DQp9DQo="},{"version":3,"sources":["banner.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiTA;AACA;AACA;AACA;AACA","file":"banner.vue","sourceRoot":"src/views/goods","sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <el-row style=\"margin-bottom: 12px\">\r\n      <el-col :span=\"5\">\r\n        <el-button icon=\"el-icon-download\" size=\"mini\" type=\"warning\" @click=\"handleExport()\">导出</el-button>\r\n        <el-button icon=\"el-icon-plus\" size=\"mini\" type=\"primary\" @click=\"handleAdd()\">新增</el-button>\r\n        <el-button icon=\"el-icon-delete\" size=\"mini\" type=\"danger\" @click=\"handleDeletes()\">删除</el-button>\r\n      </el-col>\r\n      <el-col :span=\"19\">\r\n        <el-form ref=\"queryForm\" :model=\"queryParams\" size=\"small\" style=\"float: right\" :inline=\"true\">\r\n          <el-form-item label=\"标题\" prop=\"deptName\">\r\n            <el-input\r\n              v-model=\"queryParams.title\"\r\n              placeholder=\"请输入标题\"\r\n              clearable\r\n              @keyup.enter.native=\"handleQuery\"\r\n            />\r\n          </el-form-item>\r\n          <el-form-item label=\"描述\" prop=\"status\">\r\n            <el-input\r\n              v-model=\"queryParams.description\"\r\n              placeholder=\"请输入轮播图描述\"\r\n              clearable\r\n              @keyup.enter.native=\"handleQuery\"\r\n            />\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <el-button type=\"primary\" icon=\"el-icon-search\" size=\"mini\" @click=\"handleQuery\">搜索</el-button>\r\n            <el-button icon=\"el-icon-refresh\" size=\"mini\" @click=\"resetQuery\">重置</el-button>\r\n          </el-form-item>\r\n        </el-form>\r\n      </el-col>\r\n    </el-row>\r\n    <el-table v-loading=\"listLoading\" :row-style=\"{height:'45px'}\" :cell-style=\"{padding:'0px'}\" :data=\"list\" element-loading-text=\"Loading\" border fit highlight-current-row @selection-change=\"handleSelectionChange\">\r\n      <el-table-column\r\n        type=\"selection\"\r\n        width=\"55\"\r\n      />\r\n      <el-table-column align=\"center\" label=\"编号\" prop=\"id\" width=\"100\" />\r\n      <el-table-column align=\"center\" label=\"标题\" prop=\"title\" width=\"200\" />\r\n      <el-table-column align=\"center\" label=\"描述\" prop=\"description\" />\r\n      <el-table-column label=\"激活状态\" align=\"center\" width=\"120\">\r\n        <template v-slot=\"scope\">\r\n          <el-switch\r\n            v-model=\"scope.row.isActive\"\r\n            :active-value=\"1\"\r\n            :inactive-value=\"0\"\r\n            active-color=\"#13ce66\"\r\n            inactive-color=\"#ff4949\"\r\n            @change=\"handleStatusChange(scope.row)\"\r\n          />\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"图片\" align=\"center\" width=\"220\">\r\n        <template v-slot=\"scope\">\r\n          <el-image :src=\"scope.row.imageUrl\" style=\"width:192px;height:72px;margin: 3px\" :preview-src-list=\"[scope.row.imageUrl]\" />\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"目标地址\" align=\"center\" prop=\"targetUrl\" width=\"250\" :show-overflow-tooltip=\"true\" />\r\n      <el-table-column align=\"center\" prop=\"created_at\" label=\"操作\" width=\"250\">\r\n        <template v-slot=\"scope\">\r\n          <el-button type=\"primary\" icon=\"el-icon-edit\" size=\"mini\" @click=\"handleEdit(scope.row.id)\">编辑</el-button>\r\n          <el-button type=\"danger\" icon=\"el-icon-delete\" size=\"mini\" @click=\"handleDelete(scope.row)\">删除</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <pagination v-show=\"total>0\" :total=\"total\" :page.sync=\"queryParams.pageNo\" :limit.sync=\"queryParams.pageSize\" @pagination=\"getList\" />\r\n    <el-dialog :title=\"bannerFormTitle\" :visible.sync=\"bannerFormShow\">\r\n        <el-form :rules=\"rules\"  :model=\"bannerForm\" label-width=\"80px\">\r\n          <el-form-item prop=\"title\" label=\"标题\">\r\n            <el-input v-model=\"bannerForm.title\" />\r\n          </el-form-item>\r\n          <el-form-item prop=\"description\" label=\"描述\">\r\n            <el-input v-model=\"bannerForm.description\" />\r\n          </el-form-item>\r\n          <el-form-item prop=\"isOnSell\" label=\"上架状态\">\r\n            <el-switch\r\n              v-model=\"bannerForm.isActive\"\r\n              :active-value=\"1\"\r\n              :inactive-value=\"0\"\r\n              active-color=\"#13ce66\"\r\n              inactive-color=\"#ff4949\"\r\n            />\r\n          </el-form-item>\r\n          <el-form-item  label=\"图片\">\r\n            <el-upload\r\n              :data=\"dataObj\"\r\n              action=\"http://cloud-secondhand-trading.oss-cn-shanghai.aliyuncs.com\"\r\n              accept=\"jpg,jpeg,png,PNG\"\r\n              list-type=\"picture-card\"\r\n              :on-success=\"handleImgUploadSuccess\"\r\n              :show-file-list=\"false\"\r\n              :before-upload=\"beforeUpload\">\r\n              <el-image v-if=\"bannerForm.imageUrl\" :src=\"bannerForm.imageUrl\" class=\"avatar\" />\r\n              <i v-else class=\"el-icon-plus\" />\r\n            </el-upload>\r\n          </el-form-item>\r\n          <el-form-item prop=\"targetUrl\" label=\"跳转地址\">\r\n            <el-input v-model=\"bannerForm.targetUrl\" />\r\n          </el-form-item>\r\n          <el-form-item prop=\"sort\" label=\"排序\">\r\n            <el-input v-model=\"bannerForm.sort\" />\r\n          </el-form-item>\r\n        </el-form>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button @click=\"bannerFormShow = false\">关 闭</el-button>\r\n          <el-button type=\"primary\" @click=\"saveOrUpdate()\">保 存</el-button>\r\n        </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { list, info, update, deletes, save, changeStatus } from '@/api/goods/banner'\r\nimport pagination from '@/components/Pagination'\r\nimport { exportFile } from '@/utils/request'\r\nimport { policy } from '@/api/oss/policy'\r\nimport { getUUID } from '@/utils'\r\n\r\nexport default {\r\n  components: { pagination },\r\n  filters: {\r\n    statusFilter(status) {\r\n      const statusMap = {\r\n        published: 'success',\r\n        draft: 'gray',\r\n        deleted: 'danger'\r\n      }\r\n      return statusMap[status]\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      dataObj: {},\r\n      bannerForm: {\r\n        imageUrl: '',\r\n        isActive: 0\r\n      },\r\n      checkedIds: [],\r\n      bannerFormTitle: '编辑轮播图',\r\n      bannerFormShow: false,\r\n      total: 0,\r\n      queryParams: {\r\n        pageNo: 1,\r\n        pageSize: 10\r\n      },\r\n      list: null,\r\n      listLoading: true,\r\n      // 表单校验规则\r\n      rules: {\r\n        title: [{ required: true, trigger: 'blur', message: '请先输入标题' }],\r\n        description: [{ required: true, trigger: 'blur', message: '请输入描述' }],\r\n        imageUrl: [{ required: true, trigger: 'blur', message: '请先上传图片' }],\r\n        sort: [{ required: true, trigger: 'blur', message: '请输入排序值' }, { type: 'number', message: '排序必须为数字值' }],\r\n        targetUrl: [{ required: true, trigger: 'blur', message: '请输入跳转地址' }]\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    this.getList()\r\n  },\r\n  methods: {\r\n    handleSelectionChange(values) {\r\n      this.checkedIds = []\r\n      values.map(res => this.checkedIds.push(res.id))\r\n    },\r\n    /** 导出excel文件 */\r\n    handleExport() {\r\n      exportFile('/cloud-goods/banner/export', '轮播图')\r\n    },\r\n    handleAdd() {\r\n      this.bannerForm = {\r\n        isActive: 0\r\n      }\r\n      this.bannerFormShow = true\r\n    },\r\n    /** 搜索按钮操作 */\r\n    handleQuery() {\r\n      this.getList()\r\n    },\r\n    /** 重置按钮操作 */\r\n    resetQuery() {\r\n      this.queryParams = {\r\n        pageNo: 1,\r\n        pageSize: 10\r\n      }\r\n      this.handleQuery()\r\n    },\r\n    handleDeletes() {\r\n      if (this.checkedIds.length === 0) {\r\n        this.$message({\r\n          type: 'warning',\r\n          message: '请勾选需要删除的记录!'\r\n        })\r\n        return\r\n      }\r\n      this.$confirm(`确定执行删除操作吗？`, '是否继续?', '提示', {\r\n        confirmButtonText: '删除',\r\n        cancelButtonText: '算了吧',\r\n        type: 'warning'\r\n      }).then(() => {\r\n        deletes(this.checkedIds).then(res => {\r\n          this.$message({\r\n            type: 'success',\r\n            message: '操作成功!'\r\n          })\r\n          this.getList()\r\n        })\r\n      }).catch(() => {\r\n        this.$message({\r\n          type: 'info',\r\n          message: '取消操作'\r\n        })\r\n      })\r\n    },\r\n    handleStatusChange(row) {\r\n      changeStatus(row.id, row.isActive).then(res => {\r\n        this.$message({\r\n          type: 'success',\r\n          message: '操作成功!'\r\n        })\r\n        this.getList()\r\n      })\r\n    },\r\n    getList() {\r\n      this.listLoading = true\r\n      list(this.queryParams).then(response => {\r\n        this.list = response.data.list\r\n        this.total = response.data.total\r\n        this.listLoading = false\r\n      })\r\n    },\r\n    handleEdit(id) {\r\n      info(id).then(res => {\r\n        this.bannerForm = res.data\r\n        this.bannerFormShow = true\r\n      })\r\n    },\r\n    saveOrUpdate() {\r\n      if (this.bannerForm.id) {\r\n        update(this.bannerForm).then(res => {\r\n          this.$message({\r\n            type: 'success',\r\n            message: '更新成功!'\r\n          })\r\n        })\r\n      } else {\r\n        //  添加轮播图\r\n        save(this.bannerForm).then(res => {\r\n          this.$message({\r\n            type: 'success',\r\n            message: '添加成功!'\r\n          })\r\n        })\r\n      }\r\n      this.bannerFormShow = false\r\n      this.getList()\r\n    },\r\n    handleDelete(row) {\r\n      this.$confirm(`确定删除该轮播图吗？`, '是否继续?', '提示', {\r\n        confirmButtonText: '删除',\r\n        cancelButtonText: '算了吧',\r\n        type: 'warning'\r\n      }).then(() => {\r\n        deletes([row.id]).then(res => {\r\n          this.$message({\r\n            type: 'success',\r\n            message: '操作成功!'\r\n          })\r\n          this.getList()\r\n        })\r\n      }).catch(() => {\r\n        this.$message({\r\n          type: 'info',\r\n          message: '取消操作'\r\n        })\r\n      })\r\n    },\r\n    beforeUpload(file) {\r\n      const _self = this\r\n      return new Promise((resolve, reject) => {\r\n        policy()\r\n          .then(response => {\r\n            _self.dataObj.policy = response.data.policy\r\n            _self.dataObj.signature = response.data.signature\r\n            _self.dataObj.ossaccessKeyId = response.data.accessid\r\n            _self.dataObj.key = response.data.dir + getUUID() + file.name\r\n            _self.dataObj.dir = response.data.dir\r\n            _self.dataObj.host = response.data.host\r\n            resolve(true)\r\n          })\r\n          .catch(err => {\r\n            console.log('出错了..', err)\r\n            reject(false)\r\n          })\r\n      })\r\n    },\r\n    handleImgUploadSuccess(res, file) {\r\n      this.bannerForm.imageUrl = this.dataObj.host + '/' + this.dataObj.key\r\n      this.$forceUpdate()\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.avatar {\r\n  width: 145px;\r\n  height: 145px;\r\n  display: block;\r\n}\r\n</style>\r\n"]}]}