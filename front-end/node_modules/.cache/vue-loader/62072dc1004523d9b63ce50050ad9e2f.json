{"remainingRequest":"E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\src\\views\\component\\multiUpload.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\src\\views\\component\\multiUpload.vue","mtime":1694356754354},{"path":"E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\SoftwareDevelopment\\software\\开源二手商城\\cloud-secondhand-trading\\front-end\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBwb2xpY3kgfSBmcm9tICdAL2FwaS9vc3MvcG9saWN5Jw0KaW1wb3J0IHsgZ2V0VVVJRCB9IGZyb20gJ0AvdXRpbHMnDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdNdWx0aVVwbG9hZCcsDQogIHByb3BzOiB7DQogICAgLy/lm77niYflsZ7mgKfmlbDnu4QNCiAgICB2YWx1ZTogW10sDQogICAgLy/mnIDlpKfkuIrkvKDlm77niYfmlbDph48NCiAgICBtYXhDb3VudDogew0KICAgICAgdHlwZTogTnVtYmVyLA0KICAgICAgZGVmYXVsdDogMzANCiAgICB9LA0KICAgIGxpc3RUeXBlOiB7DQogICAgICB0eXBlOiBTdHJpbmcsDQogICAgICBkZWZhdWx0OiAncGljdHVyZS1jYXJkJw0KICAgIH0sDQogICAgc2hvd0ZpbGU6IHsNCiAgICAgIHR5cGU6IEJvb2xlYW4sDQogICAgICBkZWZhdWx0OiB0cnVlDQogICAgfQ0KDQogIH0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGRhdGFPYmo6IHsNCiAgICAgICAgcG9saWN5OiAnJywNCiAgICAgICAgc2lnbmF0dXJlOiAnJywNCiAgICAgICAga2V5OiAnJywNCiAgICAgICAgb3NzYWNjZXNzS2V5SWQ6ICcnLA0KICAgICAgICBkaXI6ICcnLA0KICAgICAgICBob3N0OiAnJywNCiAgICAgICAgdXVpZDogJycNCiAgICAgIH0sDQogICAgICBkaWFsb2dWaXNpYmxlOiBmYWxzZSwNCiAgICAgIGRpYWxvZ0ltYWdlVXJsOiBudWxsDQogICAgfTsNCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICBmaWxlTGlzdCgpIHsNCiAgICAgIGxldCBmaWxlTGlzdCA9IFtdDQogICAgICBjb25zb2xlLmxvZyh0aGlzLnZhbHVlKQ0KICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnZhbHVlLmxlbmd0aDsgaSsrKSB7DQogICAgICAgIGZpbGVMaXN0LnB1c2goeyB1cmw6IHRoaXMudmFsdWVbaV0gfSkNCiAgICAgIH0NCg0KICAgICAgcmV0dXJuIGZpbGVMaXN0DQogICAgfQ0KICB9LA0KICBtb3VudGVkKCkge30sDQogIG1ldGhvZHM6IHsNCiAgICBlbWl0SW5wdXQoZmlsZUxpc3QpIHsNCiAgICAgIGxldCB2YWx1ZSA9IFtdDQogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZpbGVMaXN0Lmxlbmd0aDsgaSsrKSB7DQogICAgICAgIHZhbHVlLnB1c2goZmlsZUxpc3RbaV0udXJsKQ0KICAgICAgfQ0KICAgICAgdGhpcy4kZW1pdCgnaW5wdXQnLCB2YWx1ZSkNCiAgICB9LA0KICAgIGhhbmRsZVJlbW92ZShmaWxlLCBmaWxlTGlzdCkgew0KICAgICAgdGhpcy5lbWl0SW5wdXQoZmlsZUxpc3QpDQogICAgfSwNCiAgICBoYW5kbGVQcmV2aWV3KGZpbGUpIHsNCiAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IHRydWUNCiAgICAgIHRoaXMuZGlhbG9nSW1hZ2VVcmwgPSBmaWxlLnVybA0KICAgIH0sDQogICAgYmVmb3JlVXBsb2FkKGZpbGUpIHsNCiAgICAgIGxldCBfc2VsZiA9IHRoaXMNCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7DQogICAgICAgIHBvbGljeSgpDQogICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gew0KICAgICAgICAgICAgY29uc29sZS5sb2coJ+i/meaYr+S7gOS5iCR7ZmlsZW5hbWV9JykNCiAgICAgICAgICAgIF9zZWxmLmRhdGFPYmoucG9saWN5ID0gcmVzcG9uc2UuZGF0YS5wb2xpY3kNCiAgICAgICAgICAgIF9zZWxmLmRhdGFPYmouc2lnbmF0dXJlID0gcmVzcG9uc2UuZGF0YS5zaWduYXR1cmUNCiAgICAgICAgICAgIF9zZWxmLmRhdGFPYmoub3NzYWNjZXNzS2V5SWQgPSByZXNwb25zZS5kYXRhLmFjY2Vzc2lkDQogICAgICAgICAgICBfc2VsZi5kYXRhT2JqLmtleSA9IHJlc3BvbnNlLmRhdGEuZGlyICsgZ2V0VVVJRCgpICsgJ18ke2ZpbGVuYW1lfScNCiAgICAgICAgICAgIF9zZWxmLmRhdGFPYmouZGlyID0gcmVzcG9uc2UuZGF0YS5kaXINCiAgICAgICAgICAgIF9zZWxmLmRhdGFPYmouaG9zdCA9IHJlc3BvbnNlLmRhdGEuaG9zdA0KICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKQ0KICAgICAgICAgIH0pDQogICAgICAgICAgLmNhdGNoKGVyciA9PiB7DQogICAgICAgICAgICBjb25zb2xlLmxvZygn5Ye66ZSZ5LqGLi4uJywgZXJyKQ0KICAgICAgICAgICAgcmVqZWN0KGZhbHNlKQ0KICAgICAgICAgIH0pDQogICAgICB9KQ0KICAgIH0sDQogICAgaGFuZGxlVXBsb2FkU3VjY2VzcyhyZXMsIGZpbGUpIHsNCiAgICAgIHRoaXMuZmlsZUxpc3QucHVzaCh7DQogICAgICAgIG5hbWU6IGZpbGUubmFtZSwNCiAgICAgICAgLy8gdXJsOiB0aGlzLmRhdGFPYmouaG9zdCArICIvIiArIHRoaXMuZGF0YU9iai5kaXIgKyAiLyIgKyBmaWxlLm5hbWXvvJsg5pu/5o2iJHtmaWxlbmFtZX3kuLrnnJ/mraPnmoTmlofku7blkI0NCiAgICAgICAgdXJsOiB0aGlzLmRhdGFPYmouaG9zdCArICcvJyArIHRoaXMuZGF0YU9iai5rZXkucmVwbGFjZSgnJHtmaWxlbmFtZX0nLGZpbGUubmFtZSkNCiAgICAgIH0pDQogICAgICB0aGlzLmVtaXRJbnB1dCh0aGlzLmZpbGVMaXN0KQ0KICAgIH0sDQogICAgaGFuZGxlRXhjZWVkKGZpbGVzLCBmaWxlTGlzdCkgew0KICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgIG1lc3NhZ2U6ICfmnIDlpJrlj6rog73kuIrkvKAnICsgdGhpcy5tYXhDb3VudCArICflvKDlm77niYcnLA0KICAgICAgICB0eXBlOiAnd2FybmluZycsDQogICAgICAgIGR1cmF0aW9uOiAxMDAwDQogICAgICB9KQ0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["multiUpload.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"multiUpload.vue","sourceRoot":"src/views/component","sourcesContent":["<template>\r\n  <div>\r\n    <el-upload\r\n      action=\"http://gulimall-xfwang.oss-cn-shanghai.aliyuncs.com\"\r\n      :data=\"dataObj\"\r\n      :list-type=\"listType\"\r\n      :file-list=\"fileList\"\r\n      :before-upload=\"beforeUpload\"\r\n      :on-remove=\"handleRemove\"\r\n      :on-success=\"handleUploadSuccess\"\r\n      :on-preview=\"handlePreview\"\r\n      :limit=\"maxCount\"\r\n      :on-exceed=\"handleExceed\"\r\n      :show-file-list=\"showFile\"\r\n    >\r\n      <i class=\"el-icon-plus\"></i>\r\n    </el-upload>\r\n    <el-dialog :visible.sync=\"dialogVisible\">\r\n      <img width=\"100%\" :src=\"dialogImageUrl\" alt />\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { policy } from '@/api/oss/policy'\r\nimport { getUUID } from '@/utils'\r\nexport default {\r\n  name: 'MultiUpload',\r\n  props: {\r\n    //图片属性数组\r\n    value: [],\r\n    //最大上传图片数量\r\n    maxCount: {\r\n      type: Number,\r\n      default: 30\r\n    },\r\n    listType: {\r\n      type: String,\r\n      default: 'picture-card'\r\n    },\r\n    showFile: {\r\n      type: Boolean,\r\n      default: true\r\n    }\r\n\r\n  },\r\n  data() {\r\n    return {\r\n      dataObj: {\r\n        policy: '',\r\n        signature: '',\r\n        key: '',\r\n        ossaccessKeyId: '',\r\n        dir: '',\r\n        host: '',\r\n        uuid: ''\r\n      },\r\n      dialogVisible: false,\r\n      dialogImageUrl: null\r\n    };\r\n  },\r\n  computed: {\r\n    fileList() {\r\n      let fileList = []\r\n      console.log(this.value)\r\n      for (let i = 0; i < this.value.length; i++) {\r\n        fileList.push({ url: this.value[i] })\r\n      }\r\n\r\n      return fileList\r\n    }\r\n  },\r\n  mounted() {},\r\n  methods: {\r\n    emitInput(fileList) {\r\n      let value = []\r\n      for (let i = 0; i < fileList.length; i++) {\r\n        value.push(fileList[i].url)\r\n      }\r\n      this.$emit('input', value)\r\n    },\r\n    handleRemove(file, fileList) {\r\n      this.emitInput(fileList)\r\n    },\r\n    handlePreview(file) {\r\n      this.dialogVisible = true\r\n      this.dialogImageUrl = file.url\r\n    },\r\n    beforeUpload(file) {\r\n      let _self = this\r\n      return new Promise((resolve, reject) => {\r\n        policy()\r\n          .then(response => {\r\n            console.log('这是什么${filename}')\r\n            _self.dataObj.policy = response.data.policy\r\n            _self.dataObj.signature = response.data.signature\r\n            _self.dataObj.ossaccessKeyId = response.data.accessid\r\n            _self.dataObj.key = response.data.dir + getUUID() + '_${filename}'\r\n            _self.dataObj.dir = response.data.dir\r\n            _self.dataObj.host = response.data.host\r\n            resolve(true)\r\n          })\r\n          .catch(err => {\r\n            console.log('出错了...', err)\r\n            reject(false)\r\n          })\r\n      })\r\n    },\r\n    handleUploadSuccess(res, file) {\r\n      this.fileList.push({\r\n        name: file.name,\r\n        // url: this.dataObj.host + \"/\" + this.dataObj.dir + \"/\" + file.name； 替换${filename}为真正的文件名\r\n        url: this.dataObj.host + '/' + this.dataObj.key.replace('${filename}',file.name)\r\n      })\r\n      this.emitInput(this.fileList)\r\n    },\r\n    handleExceed(files, fileList) {\r\n      this.$message({\r\n        message: '最多只能上传' + this.maxCount + '张图片',\r\n        type: 'warning',\r\n        duration: 1000\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style>\r\n</style>\r\n"]}]}